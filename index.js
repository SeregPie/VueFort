!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueFort={},e.VueDemi)}(this,(function(e,t){"use strict";const n=()=>{},f=Array.isArray,o=e=>"function"==typeof e,i=e=>"string"==typeof e,r=e=>null!==e&&"object"==typeof e;function s(e){return!(!e||!0!==e.$isEffect)}let c,l=new WeakMap;function u(e){if(c){let{effects:t}=l.get(c);t.add(e)}}function a(e){return l.has(e)}function d(e){return!!(e&&e.$effectScope&&a(e.$effectScope))}function h(e){if(s(e)){let{stop:t}=e;return t()}if(a(e)){let{stop:t}=l.get(e);return t()}return function(e){return!!(e&&e.$effect&&s(e.$effect))}(e)?h(e.$effect):d(e)?h(e.$effectScope):void 0}function p(e,t){if(a(e)){let{extend:n}=l.get(e);return n(t)}if(d(e))return p(e.$effectScope,t)}function y(e,f){return function(e){let f,i;return o(e)?(f=e,i=n):({get:f,set:i}=e),t.customRef((()=>({get:f,set:i})))}({get:()=>e[f],set(t){e[f]=t}})}let R=new WeakMap;function b(e){let n={};if(r(e))if(t.isReactive(e)){let f=R.get(e);f||(f={},R.set(e,f));let o=t.toRaw(e);t.isReadonly(e)?Object.keys(e).forEach((i=>{let r=f[i];if(!r){if(t.isReactive(o))r=t.shallowReadonly(y(e,i));else{let n=o[i];r=t.isRef(n)?t.isReadonly(n)?n:t.shallowReadonly(n):t.shallowReadonly(y(e,i))}f[i]=r}n[i]=r})):Object.keys(e).forEach((i=>{let r=f[i];if(!r){if(t.isReactive(o))r=y(e,i);else{let n=o[i];r=t.isRef(n)?n:y(e,i)}f[i]=r}n[i]=r}))}else t.isReadonly(e)?(e=t.toRaw(e),Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?t.isReadonly(f)?f:t.shallowReadonly(f):t.shallowReadonly(t.shallowRef(f))}))):Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?f:t.shallowRef(f)}));return n}function g(e){return e.startsWith("_")}function v(e,t){return function(...n){let f;return p(e,(()=>{f=t.apply(e,n)})),f}}function j(e,n,s){if(f(s))s.forEach((t=>{j(e,n,t)}));else{let f,c;i(s)?f=e[s]:o(s)?f=v(e,s):r(s)&&(({handler:s,...c}=s),i(s)?f=e[s]:o(s)&&(f=v(e,s))),function(...e){let n=t.watch(...e);u({$isEffect:!0,stop:n})}(n,f,c)}}function E(e,f,{bind:i}={}){let r={},s=b(f),a=!1,d=e=>{e((()=>{a=!0}))},y=i?p(i,d):function(e){let n=[],f=e=>{n.push(e)},o={},i=new Set,r=e=>{if(e){let t=c;c=o;try{Object.assign(o,e(f))}finally{c=t}}return o};return l.set(o,{effects:i,extend:r,stop(){i.forEach((e=>{h(e)})),n.forEach((e=>{e()}))}}),u(o),t.getCurrentInstance()&&t.onUnmounted((()=>{h(o)})),r(e),o}(d);return Object.defineProperties(r,{$model:{value:e},$effectScope:{value:y},$destroy:{value(){h(y)}},$isDestroyed:{get:()=>a}}),p(y,(()=>{let f={},{options:{state:i=n,getters:c={},watch:l={},methods:a={}}={}}=e;Object.entries({...s,...b(i({...s}))}).forEach((([e,t])=>{f[e]={get:()=>t.value,set(e){t.value=e}}})),Object.entries(c).forEach((([e,i])=>{let s=function(e){let f,i;o(e)?(f=e,i=n):({get:f,set:i}=e);let r={$isEffect:!0,stop:n};return u(r),t.customRef(((e,n)=>{let o;return{get:()=>(o||(r.stop=t.watch(f,(e=>{o?((e,t)=>e!==t&&(e==e||t==t))(o.value,e)&&(o.value=e,n()):o={value:e}}),{flush:"sync",immediate:!0})),e(),o.value),set:i}}))}(v(r,i));f[e]={get:()=>s.value}})),Object.entries(a).forEach((([e,t])=>{f[e]={value:v(r,t)}})),Object.entries(f).forEach((([e,t])=>{Object.assign(t,{enumerable:!g(e)})})),Object.defineProperties(r,f),Object.entries(l).forEach((([e,t])=>{let n=function(e,t){let n=t.split(".");return 1===n.length?()=>e[t]:()=>function(e,t){return t.forEach((t=>{e=e[t]})),e}(e,n)}(r,e);j(r,n,t)}))})),r}e.defineModel=function(e){let t=function(...e){return E(t,...e)};return Object.defineProperties(t,{options:{get:()=>e}}),t},e.toRefs=b,Object.defineProperty(e,"__esModule",{value:!0})}));
