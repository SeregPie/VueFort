!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueFort={},e.VueDemi)}(this,(function(e,t){"use strict";var n=Object.is;function f(e){return"function"==typeof e}function i(){}function o(e){let n,o;return f(e)?(n=e,o=i):({get:n,set:o}=e),t.customRef((()=>({get:n,set:o})))}function r(e){return!(!e||!0!==e.$isEffect)}let s,c=new WeakMap;function l(e){return c.has(e)}function u(e){return!!(e&&e.$effectScope&&l(e.$effectScope))}function a(e){if(r(e)){let{stop:t}=e;return t()}if(l(e)){let{stop:t}=c.get(e);return t()}return function(e){return!!(e&&e.$effect&&r(e.$effect))}(e)?a(e.$effect):u(e)?a(e.$effectScope):void 0}function d(e){if(s){let{effects:t}=c.get(s);t.add(e)}else t.getCurrentInstance()&&t.onUnmounted((()=>{a(e)}))}function h(e){let t=[],n=e=>{t.push(e)},f={},i=new Set,o=e=>{if(e){let t=s;s=f;try{Object.assign(f,e(n))}finally{s=t}}return f};return c.set(f,{effects:i,extend:o,stop(){i.forEach((e=>{a(e)})),t.forEach((e=>{e()}))}}),d(f),o(e),f}function p(e,t){if(l(e)){let{extend:n}=c.get(e);return n(t)}if(u(e))return p(e.$effectScope,t)}var b=Array.isArray;function v(e){if(e){let t=typeof e;return"object"===t||"function"===t}return!1}function y(e){return"string"==typeof e}function g(e,t){return o({get:()=>e[t],set(n){e[t]=n}})}let R=new WeakMap;function j(e){let n={};if(v(e))if(t.isReactive(e)){let f=R.get(e);f||(f={},R.set(e,f));let i=t.toRaw(e);t.isReadonly(e)?Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=t.shallowReadonly(g(e,o));else{let n=i[o];r=t.isRef(n)?t.isReadonly(n)?n:t.shallowReadonly(n):t.shallowReadonly(g(e,o))}f[o]=r}n[o]=r})):Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=g(e,o);else{let n=i[o];r=t.isRef(n)?n:g(e,o)}f[o]=r}n[o]=r}))}else t.isReadonly(e)?(e=t.toRaw(e),Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?t.isReadonly(f)?f:t.shallowReadonly(f):t.shallowReadonly(t.shallowRef(f))}))):Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?f:t.shallowRef(f)}));return n}function O(e,n,i){let o=i.split("."),r=1===o.length?()=>e[i]:()=>function(e,t){return t.forEach((t=>{e=e[t]})),e}(e,o),s=n=>{let i,o;y(n)?i=e[n]:f(n)?i=n.bind(e):v(n)&&(({handler:n,...o}=n),y(n)?i=e[n]:f(n)&&(i=n.bind(e))),function(...e){let n=t.watch(...e);d({$isEffect:!0,stop:n})}(r,i,o)};b(n)?n.forEach(s):s(n)}function w(e){return e.startsWith("_")}function E(e,r,{bind:s=!0}={}){let c=j(r),l=Object.keys(c);r=t.shallowRef(t.reactive(c)),c={},l.forEach((e=>{c[e]=o({get:()=>r.value[e],set(t){r.value[e]=t}})}));let u=!1,b=function(e,t){if(!0===e)return h(t);let n;return p(e,(()=>{n=h(t)})),n}(s,(e=>{e((()=>{u=!0}))})),v={};return Object.defineProperties(v,{$model:{value:e},$effectScope:{value:b},$data:{get:()=>r.value,set(e){r.value=t.reactive(j(e))}},$update:{value(e){Object.assign(v,{$data:e})}},$destroy:{value(){a(b)}},$isDestroyed:{get:()=>u}}),p(b,(()=>{let r={},{options:{state:s=i,getters:l={},watch:u={},methods:a={}}={}}=e;Object.entries({...c,...j(s({...c}))}).forEach((([e,t])=>{r[e]={get:()=>t.value,set(e){t.value=e}}})),Object.entries(l).forEach((([e,s])=>{let c=function(e){let r,s;f(e)?(r=e,s=i):({get:r,set:s}=e);let c,l={$isEffect:!0,stop:i};return d(l),o({get:()=>(c||(l.stop=t.watch(r,(e=>{c?n(c.value,e)||(c.value=e):c=t.shallowRef(e)}),{flush:"sync",immediate:!0})),c.value),set:s})}(s.bind(v));r[e]={get:()=>c.value}})),Object.entries(a).forEach((([e,t])=>{r[e]={value:t.bind(v)}})),Object.entries(r).forEach((([e,t])=>{Object.assign(t,{enumerable:!w(e)})})),Object.defineProperties(v,r),Object.entries(u).forEach((([e,t])=>{O(v,t,e)}))})),v}e.c=function(...e){return E(...e)},e.defineModel=function(e){e=t.shallowRef(e);let n=function(...e){return E(n,...e)};return Object.defineProperties(n,{options:{get:()=>e.value,set(t){e.value=t}},update:{value(e){Object.assign(n,{options:e})}}}),n},e.toRefs=j,Object.defineProperty(e,"__esModule",{value:!0})}));
