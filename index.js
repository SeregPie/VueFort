!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueFort={},e.VueDemi)}(this,(function(e,t){"use strict";var n=Object.is;function f(e){return"function"==typeof e}function i(){}function o(e){let n,o;return f(e)?(n=e,o=i):({get:n,set:o}=e),t.customRef((()=>({get:n,set:o})))}function r(e){return!(!e||!0!==e.$isEffect)}let s,c=new WeakMap;function l(e){return c.has(e)}function u(e){return!!(e&&e.$effectScope&&l(e.$effectScope))}function a(e){if(r(e)){let{stop:t}=e;return t()}if(l(e)){let{stop:t}=c.get(e);return t()}return function(e){return!!(e&&e.$effect&&r(e.$effect))}(e)?a(e.$effect):u(e)?a(e.$effectScope):void 0}function d(e){if(s){let{effects:t}=c.get(s);t.add(e)}else t.getCurrentInstance()&&t.onUnmounted((()=>{a(e)}))}function h(e){let t=[],n=e=>{t.push(e)},f={},i=new Set,o=e=>{if(e){let t=s;s=f;try{Object.assign(f,e(n))}finally{s=t}}return f};return c.set(f,{effects:i,extend:o,stop(){i.forEach((e=>{a(e)})),t.forEach((e=>{e()}))}}),d(f),o(e),f}function p(e,t){if(l(e)){let{extend:n}=c.get(e);return n(t)}if(u(e))return p(e.$effectScope,t)}function b(e){let r,s;f(e)?(r=e,s=i):({get:r,set:s}=e);let c,l={$isEffect:!0,stop:i};return d(l),o({get:()=>(c||(l.stop=t.watch(r,(e=>{c?n(c.value,e)||(c.value=e):c=t.shallowRef(e)}),{flush:"sync",immediate:!0})),c.value),set:s})}var v=Array.isArray;function y(e){if(e){let t=typeof e;return"object"===t||"function"===t}return!1}function g(e){return"string"==typeof e}function R(e,t){return o({get:()=>e[t],set(n){e[t]=n}})}let j=new WeakMap;function O(e){let n={};if(y(e))if(t.isReactive(e)){let f=j.get(e);f||(f={},j.set(e,f));let i=t.toRaw(e);t.isReadonly(e)?Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=t.shallowReadonly(R(e,o));else{let n=i[o];r=t.isRef(n)?t.isReadonly(n)?n:t.shallowReadonly(n):t.shallowReadonly(R(e,o))}f[o]=r}n[o]=r})):Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=R(e,o);else{let n=i[o];r=t.isRef(n)?n:R(e,o)}f[o]=r}n[o]=r}))}else t.isReadonly(e)?(e=t.toRaw(e),Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?t.isReadonly(f)?f:t.shallowReadonly(f):t.shallowReadonly(t.shallowRef(f))}))):Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?f:t.shallowRef(f)}));return n}function w(e,n,i){let o=i.split("."),r=1===o.length?()=>e[i]:()=>function(e,t){return t.forEach((t=>{e=e[t]})),e}(e,o),s=n=>{let i,o;g(n)?i=e[n]:f(n)?i=n.bind(e):y(n)&&(({handler:n,...o}=n),g(n)?i=e[n]:f(n)&&(i=n.bind(e))),function(...e){let n=t.watch(...e);d({$isEffect:!0,stop:n})}(r,i,o)};v(n)?n.forEach(s):s(n)}function E(e){return e.startsWith("_")}function $(e,n,{bind:f=!0}={}){let o={},r=O(n),s=Object.keys(r);n=t.shallowRef(t.reactive(r));let c=!1,l=function(e,t){if(!0===e)return h(t);let n;return p(e,(()=>{n=h(t)})),n}(f,(e=>{e((()=>{c=!0})),r={},s.forEach((e=>{r[e]=b({get:()=>n.value[e],set(t){n.value[e]=t}})}))}));return Object.defineProperties(o,{$model:{value:e},$effectScope:{value:l},$data:{get:()=>n.value,set(e){n.value=t.reactive(O(e))}},$update:{value(e){Object.assign(o,{$data:e})}},$destroy:{value(){a(l)}},$isDestroyed:{get:()=>c}}),p(l,(()=>{let t={},{options:{state:n=i,getters:f={},watch:s={},methods:c={}}={}}=e;Object.entries({...r,...O(n({...r}))}).forEach((([e,n])=>{t[e]={get:()=>n.value,set(e){n.value=e}}})),Object.entries(f).forEach((([e,n])=>{let f=b(n.bind(o));t[e]={get:()=>f.value}})),Object.entries(c).forEach((([e,n])=>{t[e]={value:n.bind(o)}})),Object.entries(t).forEach((([e,t])=>{Object.assign(t,{enumerable:!E(e)})})),Object.defineProperties(o,t),Object.entries(s).forEach((([e,t])=>{w(o,t,e)}))})),o}e.c=function(...e){return $(...e)},e.defineModel=function(e){e=t.shallowRef(e);let n=function(...e){return $(n,...e)};return Object.defineProperties(n,{options:{get:()=>e.value,set(t){e.value=t}},update:{value(e){Object.assign(n,{options:e})}}}),n},e.toRefs=O,Object.defineProperty(e,"__esModule",{value:!0})}));
