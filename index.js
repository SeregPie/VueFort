!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue-demi")):"function"==typeof define&&define.amd?define(["exports","vue-demi"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueFort={},e.VueDemi)}(this,(function(e,t){"use strict";function n(e){return"function"==typeof e}function f(){}function i(e){return!(!e||!0!==e.$isEffect)}let o,r=new WeakMap;function c(e){return r.has(e)}function s(e){return!!(e&&e.$effectScope&&c(e.$effectScope))}function u(e){if(i(e)){let{stop:t}=e;return t()}if(c(e)){let{stop:t}=r.get(e);return t()}return function(e){return!!(e&&e.$effect&&i(e.$effect))}(e)?u(e.$effect):s(e)?u(e.$effectScope):void 0}function l(e){if(o){let{effects:t}=r.get(o);t.add(e)}else t.getCurrentInstance()&&t.onUnmounted((()=>{u(e)}))}function a(e){let t=[],n=e=>{t.push(e)},f={},i=new Set,c=e=>{if(e){let t=o;o=f;try{Object.assign(f,e(n))}finally{o=t}}return f};return r.set(f,{effects:i,extend:c,stop(){i.forEach((e=>{u(e)})),t.forEach((e=>{e()}))}}),l(f),c(e),f}function d(e,t){if(c(e)){let{extend:n}=r.get(e);return n(t)}if(s(e))return d(e.$effectScope,t)}function h(e){if(e){let t=typeof e;return"object"===t||"function"===t}return!1}function p(e){return e.startsWith("_")}function y(e,t,n){t.startsWith("$")||t in e||Object.defineProperty(e,t,{configurable:!1,enumerable:!p(t),...n})}function b(e,i){void 0!==i&&h(i)&&Object.entries(i).forEach((([i,o])=>{n(o)&&(o=function(e){let i,o;n(e)?(i=e,o=f):({get:i,set:o}=e);let r,c=!0;return l({$isEffect:!0,stop(){c=!1}}),t.computed({get:()=>(c&&(r=i()),r),set:o})}(o.bind(e)),y(e,i,{get:()=>o.value}))}))}function v(e,t){void 0!==t&&h(t)&&Object.keys(t).forEach((n=>{y(e,n,{get:()=>t[n],set(e){t[n]=e}})}))}var R=Array.isArray;function g(e){return"string"==typeof e}function j(e,f){void 0!==f&&h(f)&&Object.entries(f).forEach((([f,i])=>{let o=(t=>{let n=t.split(".");return 1===n.length?()=>e[t]:()=>function(e,t){return t.forEach((t=>{e=e[t]})),e}(e,n)})(f);var r;r=f=>{let i,r;g(f)?i=e[f]:n(f)?i=f.bind(e):h(f)&&(({handler:f,...r}=f),g(f)?i=e[f]:n(f)&&(i=f.bind(e))),function(...e){let n=t.watch(...e);l({$isEffect:!0,stop:n})}(o,i,r)},R(i)?i.forEach(r):r(i)}))}function E(e,i){return function(e){let i,o;return n(e)?(i=e,o=f):({get:i,set:o}=e),t.customRef((()=>({get:i,set:o})))}({get:()=>e[i],set(t){e[i]=t}})}let w=new WeakMap;e.createInstance=function({state:e,getters:f,watch:i,methods:o,bind:r=!0}={}){let l=!1,p=((e,t)=>{if(!0===e)return a(t);if(c(e)||s(e)){let n;return d(e,(()=>{n=a(t)})),n}})(r,(e=>{e((()=>{l=!0}))})),R=Object.create(null);return Object.defineProperties(R,{$effectScope:{value:p},$destroy:{value(){u(p)}},$isDestroyed:{get:()=>l}}),d(p,(()=>{var r,c;b(R,f),r=R,void 0!==(c=o)&&h(c)&&Object.entries(c).forEach((([e,t])=>{n(t)&&y(r,e,{value:t.bind(r)})})),function(e,f){void 0!==f&&(n(f)?void 0!==(f=f.call(e))&&h(f)&&v(e,f=t.reactive(f)):h(f)&&v(e,f=t.reactive(f)))}(R,e),j(R,i)})),R},e.toRefs=function(e){let n={};if(h(e))if(t.isReactive(e)){let f=w.get(e);f||(f={},w.set(e,f));let i=t.toRaw(e);t.isReadonly(e)?Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=t.shallowReadonly(E(e,o));else{let n=i[o];r=t.isRef(n)?t.isReadonly(n)?n:t.shallowReadonly(n):t.shallowReadonly(E(e,o))}f[o]=r}n[o]=r})):Object.keys(e).forEach((o=>{let r=f[o];if(!r){if(t.isReactive(i))r=E(e,o);else{let n=i[o];r=t.isRef(n)?n:E(e,o)}f[o]=r}n[o]=r}))}else t.isReadonly(e)?(e=t.toRaw(e),Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?t.isReadonly(f)?f:t.shallowReadonly(f):t.shallowReadonly(t.shallowRef(f))}))):Object.entries(e).forEach((([e,f])=>{n[e]=t.isRef(f)?f:t.shallowRef(f)}));return n},Object.defineProperty(e,"__esModule",{value:!0})}));
